var wBooksApp=angular.module("wBooksApp",["ngResource","ngRoute"]);wBooksApp.controller("resultsCtrl",["$scope","$http","FavoriteService",function(t,e,o){t.wasSearched=!1,t.invalidSearch=!1,t.thereAreMoreBooks=!1,t.loadDefault=!1,t.loadItems=!1,t.loadBookData=!1,t.getBookData=!1,t.getSearch=function(){t.loadDefault=!0;var e=t.searchTerm.replace(/ /g,"+"),o=0;a(e,o),t.getPage=function(){t.loadItems=!0,totalItems-=10,totalItems>0&&(o+=10,a(e,o))}};var a=function(o,a){url="https://www.googleapis.com/books/v1/volumes?q="+o+"&startIndex="+a+"&key=AIzaSyDE0-szZIrViSPNB284ckdUhvp3pyFLPsY",e.get(url).then(function(e){t.actualSearchTerm=t.searchTerm,e.data.items?(0==a?(totalItems=e.data.totalItems,t.bookResults=e.data.items,t.searchStatus="itemsFound"):(t.bookResults=t.bookResults.concat(e.data.items),t.loadItems=!1),totalItems>=10?t.thereAreMoreBooks=!0:t.thereAreMoreBooks=!1,s(t.bookResults)):t.searchStatus="404",t.loadDefault=!1})};t.bookInfo=function(o){t.getBookData=!0,t.loadBookData=!0,e.get("https://www.googleapis.com/books/v1/volumes/"+o+"?key=AIzaSyDE0-szZIrViSPNB284ckdUhvp3pyFLPsY").then(function(e){t.bookData=e.data,t.loadBookData=!1})};var s=function(t){for(var e=0;e<t.length;e++)t[e].isLocalStorageEnable=o.isLocalStorageEnable,t[e].isFavorite=o.isFavorite(t[e]),itemTesting="alok2",t[e].markAs=function(t){switch(thisItem=this,t){case!0:o.setFav(thisItem);break;case!1:o.deleteFav(thisItem)}thisItem.isFavorite=t}}}]),wBooksApp.service("FavoriteService",[function(){this.isLocalStorageEnable=function(){return"undefined"!=typeof Storage},this.isFavorite=function(t){return"1"===localStorage.getItem(t.id)},this.setFav=function(t){localStorage.setItem(t.id,"1")},this.deleteFav=function(t){localStorage.removeItem(t.id)}}]),wBooksApp.filter("yearFilter",function(){return function(t){if(null!==t){return new Date(t).getFullYear()}}}),wBooksApp.filter("htmlFilter",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]);