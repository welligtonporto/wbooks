var wBooksApp=angular.module("wBooksApp",["ngResource","ngRoute"]);
wBooksApp.controller("booksCtrl",["$scope","$http","BookSearchService","BookDataService",function(e,t,a,o){e.showLoadDefault=!1,e.showLoadPagination=!1,e.showItemData=!1,e.getSearch=function(){e.showLoadDefault=!0,searchedTerm=e.typingSearchTerm.replace(/ /g,"+"),indexOfFirstItemOfThisPage=0,a.getSearch(searchedTerm,indexOfFirstItemOfThisPage,e)},e.getMoreItems=function(){e.showLoadPagination=!0,totalItemsForShow-=10,indexOfFirstItemOfThisPage+=10,a.getSearch(searchedTerm,indexOfFirstItemOfThisPage,e)},e.getItemData=function(t){e.showItemData=!0,e.showLoadItemData=!0,o.getData(t,e)}}]);
wBooksApp.filter("yearFilter",function(){return function(t){if(null!==t){return new Date(t).getFullYear()}}}),wBooksApp.filter("htmlFilter",["$sce",function(t){return function(r){return t.trustAsHtml(r)}}]);
wBooksApp.service("BookSearchService",["$http","FavoriteService",function(t,e){this.getSearch=function(o,i,a){urlOfJson="https://www.googleapis.com/books/v1/volumes?q="+o+"&startIndex="+i+"&key=AIzaSyDE0-szZIrViSPNB284ckdUhvp3pyFLPsY",t.get(urlOfJson).then(function(t){a.actualSearchTerm=a.typingSearchTerm,t.data.items?(0==i?(totalItemsForShow=t.data.totalItems,a.itemsFound=t.data.items,a.searchStatus="itemsFound"):(a.itemsFound=a.itemsFound.concat(t.data.items),a.showLoadPagination=!1),totalItemsForShow>=10?a.thereAreMoreItems=!0:a.thereAreMoreItems=!1,e.getService(a.itemsFound,"calledFromBookSearch")):a.searchStatus="404",a.showLoadDefault=!1})}}]),wBooksApp.service("BookDataService",["$http","FavoriteService",function(t,e){this.getData=function(o,i){t.get("https://www.googleapis.com/books/v1/volumes/"+o+"?key=AIzaSyDE0-szZIrViSPNB284ckdUhvp3pyFLPsY").then(function(t){i.itemData=t.data,i.showLoadItemData=!1,e.getService(i.itemData,"calledFromBookData")})}}]),wBooksApp.service("FavoriteService",[function(){thisService=this,this.getService=function(t,e){var o=function(t){t.verifyIfBrowserSupportsLocalStorage=thisService.verifyIfBrowserSupportsLocalStorage,t.isFavorite=thisService.isFavorite(t),t.statusFavorite=function(t){switch(thisItemFound=this,t){case!0:thisService.setItemAsFavorite(thisItemFound);break;case!1:thisService.setItemAsNotFavorite(thisItemFound)}thisItemFound.isFavorite=t}};switch(e){case"calledFromBookSearch":for(var i=0;i<t.length;i++)itemForControlStatusFavorite=t[i],o(itemForControlStatusFavorite);break;case"calledFromBookData":itemForControlStatusFavorite=t,o(itemForControlStatusFavorite)}},this.verifyIfBrowserSupportsLocalStorage=function(){return"undefined"!=typeof Storage},this.isFavorite=function(t){return"1"===localStorage.getItem(t.id)},this.setItemAsFavorite=function(t){localStorage.setItem(t.id,"1")},this.setItemAsNotFavorite=function(t){localStorage.removeItem(t.id)}}]);